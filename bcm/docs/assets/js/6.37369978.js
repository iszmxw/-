(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{187:function(t,s,a){"use strict";a.r(s);var r=a(0),n=Object(r.a)({},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"对接动态so库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#对接动态so库","aria-hidden":"true"}},[t._v("#")]),t._v(" 对接动态so库")]),t._v(" "),a("h2",{attrs:{id:"对接前准备"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#对接前准备","aria-hidden":"true"}},[t._v("#")]),t._v(" 对接前准备")]),t._v(" "),a("div",{staticClass:"tip custom-block"},[a("p",{staticClass:"custom-block-title"},[t._v("条件")]),t._v(" "),a("p",[t._v("1、需要准备编译后的so动态库文件libbcm.so，下面是准备好了的文件点击下载即可\n2、linux服务器一台，我这里用的是阿里云服务器\n3、PHP运行环境准备一个，我这里用的是PHP5.6.40版本")])]),t._v(" "),a("p",[a("strong",[t._v("文件地址.")])]),t._v(" "),a("blockquote",[a("p",[a("a",{attrs:{href:"http://iszmxw.github.io/bcm/file/so/BCM-SO.zip",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://iszmxw.github.io/bcm/file/so/BCM-SO.zip"),a("OutboundLink")],1)])]),t._v(" "),a("p",[a("strong",[t._v("安装PHP运行环境所需要的软件.")])]),t._v(" "),a("blockquote",[a("p",[t._v("这里我们所使用的是宝塔面板 "),a("code",[t._v("BT-Panel 5.2.0")]),t._v(" "),a("br"),t._v("\nNginx使用的是"),a("code",[t._v("Nginx 1.12")]),t._v(", PHP安装的"),a("code",[t._v("PHP5.6.40")]),a("br"),t._v("\n安装好后，我们创建一个站点，运用"),a("code",[t._v("phpinfo()")]),t._v("以及"),a("code",[t._v("php -m")]),t._v("检测php的扩展以及一些基本参数")])]),t._v(" "),a("p",[a("strong",[t._v("效果如下.")])]),t._v(" "),a("p",[a("img",{attrs:{src:"http://iszmxw.github.io/bcm/file/images/QQ%E6%88%AA%E5%9B%BE20190916164805.png",alt:"iszmxw",title:"QQ截图20190916164805.png"}})]),t._v(" "),a("p",[a("strong",[t._v("根据动态库创建PHP扩展：")])]),t._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# cd到PHP安装包的目录")]),t._v("\ncd "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("www"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("server"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("php"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("56"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("src"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("ext"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 新增一个扩展初始结构目录")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("ext_skel "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("extname=iszmxw\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 进入到新增的扩展目录")]),t._v("\ncd iszmxw"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看扩展目录所在位置")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("pwd")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("www"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("server"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("php"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("56"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("src"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("ext"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("iszmxw\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 下面上传动态库文件到服务器中，使用xftp即可上传，这里不再赘述了。（上传到自己建立的一个目录即可）")]),t._v("\n\n")])])]),a("p",[a("strong",[t._v("生成动态库的lib库.")])]),t._v(" "),a("blockquote",[a("p",[t._v("我这里将文件上传到了新建的网站目录中")])]),t._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 将文件755")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[root@izwz92vqrxu3bz3edk0mytz 119.23.59.129]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# chmod 755 *")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[root@izwz92vqrxu3bz3edk0mytz 119.23.59.129]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ll -a")]),t._v("\ntotal 24\ndrwxr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("xr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("x 2 www  www  4096 Sep 16 17:16 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\ndrwxr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("xr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("x 4 root root 4096 Sep 16 16:45 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("rwxr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("xr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("x 1 root root  262 Sep 16 17:16 Cal"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("h\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("rwxr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("xr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("x 1 root root   17 Sep 16 16:46 index"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("php\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("rwxr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("xr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("x 1 root root 7904 Sep 16 17:16 libbcm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("so\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 将so文件放到系统中")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[root@izwz92vqrxu3bz3edk0mytz 119.23.59.129]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# su")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[root@izwz92vqrxu3bz3edk0mytz 119.23.59.129]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# echo /usr/local/lib > /etc/ld.so.conf.d/local.conf")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[root@izwz92vqrxu3bz3edk0mytz 119.23.59.129]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# cp libbcm.so /usr/local/lib")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[root@izwz92vqrxu3bz3edk0mytz 119.23.59.129]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# /sbin/ldconfig")]),t._v("\n")])])]),a("p",[a("strong",[t._v("下面开始准备更改php扩展.")])]),t._v(" "),a("blockquote",[a("p",[t._v("使用php扩展调用动态库，由于上一步的操作，将bcm动态链接到lib库，即可方便的调用了")])]),t._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# cd到扩展目录")]),t._v("\ncd "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("www"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("server"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("php"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("56"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("src"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("ext"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("iszmxw\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看扩展目录下有如下默认文件以及目录")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[root@izwz92vqrxu3bz3edk0mytz iszmxw]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ll -a")]),t._v("\ntotal 44\ndrwxr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("xr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("x  3 root root 4096 Sep 16 17:08 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\ndrwxrwxr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("x 77 root root 4096 Sep 16 17:08 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("rw"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("r-"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("r-"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("  1 root root 2824 Sep 16 17:08 config"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("m4\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("rw"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("r-"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("r-"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("  1 root root  352 Sep 16 17:08 config"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("w32\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("rw"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("r-"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("r-"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("  1 root root    7 Sep 16 17:08 CREDITS\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("rw"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("r-"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("r-"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("  1 root root    0 Sep 16 17:08 EXPERIMENTAL\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("rw"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("r-"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("r-"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("  1 root root  392 Sep 16 17:08 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("gitignore\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("rw"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("r-"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("r-"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("  1 root root 5152 Sep 16 17:08 iszmxw"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("c\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("rw"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("r-"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("r-"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("  1 root root  502 Sep 16 17:08 iszmxw"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("php\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("rw"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("r-"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("r-"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("  1 root root 2315 Sep 16 17:08 php_iszmxw"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("h\ndrwxr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("xr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("x  2 root root 4096 Sep 16 17:08 tests\n")])])]),a("p",[a("strong",[t._v("首先编辑 "),a("code",[t._v("config.m4")]),t._v(" 文件，去掉第16行和第18行的注释（注释符号为 dnl 。）.")])]),t._v(" "),a("blockquote",[a("p",[t._v("修改后的结果如下")])]),t._v(" "),a("div",{staticClass:"language-c extra-class"},[a("pre",{pre:!0,attrs:{class:"language-c"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("PHP_ARG_ENABLE")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("iszmxw"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" whether to enable iszmxw support"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\ndnl Make sure that the comment is aligned"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("enable"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("iszmxw           Enable iszmxw support"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[a("strong",[t._v("然后打开 php_iszmxw.h，在 "),a("code",[t._v("PHP_FUNCTION(confirm_iszmxw_compiled);")]),t._v(" 之下加入函数声明：")])]),t._v(" "),a("div",{staticClass:"language-c extra-class"},[a("pre",{pre:!0,attrs:{class:"language-c"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("PHP_FUNCTION")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("confirm_iszmxw_compiled"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* For testing, remove later. */")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("PHP_FUNCTION")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("bcm_cal"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[a("strong",[t._v("打开 iszmxw.c，在 "),a("code",[t._v("PHP_FE(confirm_iszmxw_compiled, NULL)")]),t._v(" 下方加入以下内容。")])]),t._v(" "),a("div",{staticClass:"language-c extra-class"},[a("pre",{pre:!0,attrs:{class:"language-c"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" zend_function_entry iszmxw_functions"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("PHP_FE")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("confirm_iszmxw_compiled"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("NULL")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("           "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* For testing, remove later. */")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("PHP_FE")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("bcm_cal"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("   "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("NULL")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("       "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* For testing, remove later. */")]),t._v("\n        PHP_FE_END      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* Must be the last line in iszmxw_functions[] */")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[a("strong",[t._v("然后在 iszmxw.c 的最末尾书写"),a("code",[t._v("bcm_cal")]),t._v("函数的内容：")])]),t._v(" "),a("div",{staticClass:"language-c extra-class"},[a("pre",{pre:!0,attrs:{class:"language-c"}},[a("code",[t._v("Infor infor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n * 返回传入的年龄\n */")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("PHP_FUNCTION")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("bcm_cal"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" isage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" isgender"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("double")]),t._v(" isheight"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("double")]),t._v(" isweight"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("double")]),t._v(" isresistance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" result"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("zend_parse_parameters")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ZEND_NUM_ARGS")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" TSRMLS_CC"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"llddd"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("isage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("isgender"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("isheight"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("isweight"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("isresistance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" FAILURE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    infor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("age "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" isage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    infor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("height "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" isheight"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    infor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("weight "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" isweight"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    infor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("resistance "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" isresistance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("isgender "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        infor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("gender "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" male"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        infor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("gender "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" female"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("BCM_Cal")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("infor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    result "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" infor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("TBW"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("RETURN_DOUBLE")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("result"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("blockquote",[a("p",[t._v("由于引入了"),a("code",[t._v("Infor infor;")]),t._v(",则需要在"),a("code",[t._v("iszmxw.c")]),t._v("顶部引用下面代码")])]),t._v(" "),a("div",{staticClass:"language-c extra-class"},[a("pre",{pre:!0,attrs:{class:"language-c"}},[a("code",[a("span",{pre:!0,attrs:{class:"token macro property"}},[t._v("#"),a("span",{pre:!0,attrs:{class:"token directive keyword"}},[t._v("include")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Cal.h"')])]),t._v("\n")])])]),a("blockquote",[a("p",[t._v("最后将"),a("code",[t._v("Cal.h")]),t._v("传入到扩展的目录下面")])]),t._v(" "),a("p",[a("strong",[t._v("最后进行PHP扩展的编译和安装了。")])]),t._v(" "),a("blockquote",[a("p",[t._v("1、首先执行 "),a("code",[t._v("phpize")]),t._v(" 程序，生成configure脚本：")])]),t._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[t._v("phpize\n")])])]),a("blockquote",[a("p",[t._v("2、然后进行编译和安装")])]),t._v(" "),a("div",{staticClass:"language-c extra-class"},[a("pre",{pre:!0,attrs:{class:"language-c"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("configure "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("with"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("php"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("config"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("www"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("server"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("php"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("56")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("php"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("config\nmake LDFLAGS"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("lbcm # 按照动态库安装\nmake install\n")])])]),a("blockquote",[a("p",[t._v("3、修改PHP配置文件，加载安装的扩展")])]),t._v(" "),a("div",{staticClass:"language-c extra-class"},[a("pre",{pre:!0,attrs:{class:"language-c"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@izwz92vqrxu3bz3edk0mytz iszmxw"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("# php "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("ini\nConfiguration File "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("php"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ini"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" Path"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("www"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("server"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("php"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("56")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("etc\nLoaded Configuration File"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("         "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("www"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("server"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("php"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("56")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("etc"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("php"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ini\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@izwz92vqrxu3bz3edk0mytz iszmxw"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("# vim "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("www"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("server"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("php"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("56")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("etc"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("php"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ini # 修改配置文件\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@izwz92vqrxu3bz3edk0mytz iszmxw"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("# "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("etc"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("init"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("d"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("php"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("fpm"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("56")]),t._v(" restart # 重启php\n")])])]),a("p",[a("strong",[t._v("最后编辑网站中的PHP文件使用该方法，尝一下，看是否可以运行。")])]),t._v(" "),a("div",{staticClass:"language-c extra-class"},[a("pre",{pre:!0,attrs:{class:"language-c"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@izwz92vqrxu3bz3edk0mytz "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("119.23")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v(".59")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v(".129")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("# vim "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("www"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("wwwroot"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("119.23")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v(".59")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v(".129")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("index"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("php \n\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v("php\necho "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"bcm_cal="')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("bcm_cal")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("36")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("168.5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("63.5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("600")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"<br>"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("blockquote",[a("p",[t._v("然后退出保存，查看运行结果，php /www/wwwroot/119.23.59.129/index.php")])]),t._v(" "),a("div",{staticClass:"language-c extra-class"},[a("pre",{pre:!0,attrs:{class:"language-c"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@izwz92vqrxu3bz3edk0mytz "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("119.23")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v(".59")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v(".129")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("# php "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("www"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("wwwroot"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("119.23")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v(".59")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v(".129")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("index"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("php\nin so ：TBW "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" resistance "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("600.000000")]),t._v("\nbcm_cal"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("600")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("br"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@izwz92vqrxu3bz3edk0mytz "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("119.23")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v(".59")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v(".129")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("#\n")])])])])},[],!1,null,null,null);s.default=n.exports}}]);