(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{187:function(t,s,a){"use strict";a.r(s);var n=a(0),r=Object(n.a)({},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"对接动态so库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#对接动态so库","aria-hidden":"true"}},[t._v("#")]),t._v(" 对接动态so库")]),t._v(" "),a("p",[a("strong",[t._v("下面开始准备更改php扩展。")])]),t._v(" "),a("blockquote",[a("p",[t._v("使用php扩展调用动态库，由于上一步的操作，将bcm动态链接到lib库，即可方便的调用了")])]),t._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# cd到扩展目录")]),t._v("\ncd "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("www"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("server"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("php"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("56"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("src"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("ext"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("iszmxw\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看扩展目录下有如下默认文件以及目录")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[root@izwz92vqrxu3bz3edk0mytz iszmxw]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ll -a")]),t._v("\ntotal 68\ndrwxr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("xr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("x  4 root root  4096 Sep 26 17:15 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\ndrwxr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("xr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("x 80 www  www   4096 Sep 25 18:16 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("rw"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("r-"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("r-"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("  1 root root   671 Sep 26 10:16 Cal"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("h\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("rw"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("r-"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("r-"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("  1 root root  2042 Sep 26 10:16 config"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("m4\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("rw"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("r-"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("r-"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("  1 root root   296 Sep 26 10:16 config"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("w32\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("rw"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("r-"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("r-"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("  1 root root     6 Sep 26 10:16 CREDITS\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("rw"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("r-"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("r-"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("  1 root root     0 Sep 26 10:16 EXPERIMENTAL\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("rw"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("r-"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("r-"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("  1 root root   398 Sep 26 10:16 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("gitignore\ndrwxr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("xr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("x  2 root root  4096 Sep 25 18:19 include\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("rw"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("r-"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("r-"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("  1 root root  7468 Sep 26 10:16 iszmxw"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("c\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("rw"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("r-"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("r-"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("  1 root root   502 Sep 26 10:16 iszmxw"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("php\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("rw"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("r-"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("r-"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("  1 root root 13112 Sep 26 10:16 libbcm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("so\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("rw"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("r-"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("r-"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("  1 root root  2751 Sep 26 10:16 php_iszmxw"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("h\ndrwxr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("xr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("x  2 root root  4096 Sep 25 18:16 tests\n")])])]),a("p",[a("strong",[t._v("1、首先编辑 "),a("code",[t._v("config.m4")]),t._v(" 文件，去掉第16行和第18行的注释（注释符号为 dnl 。）.")])]),t._v(" "),a("blockquote",[a("p",[t._v("修改后的结果如下")])]),t._v(" "),a("div",{staticClass:"language-c extra-class"},[a("pre",{pre:!0,attrs:{class:"language-c"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("PHP_ARG_ENABLE")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("iszmxw"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" whether to enable iszmxw support"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\ndnl Make sure that the comment is aligned"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("enable"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("iszmxw           Enable iszmxw support"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[a("strong",[t._v("2、然后打开 php_iszmxw.h，在 "),a("code",[t._v("PHP_FUNCTION(confirm_iszmxw_compiled);")]),t._v(" 之下加入函数声明：")])]),t._v(" "),a("div",{staticClass:"language-c extra-class"},[a("pre",{pre:!0,attrs:{class:"language-c"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("PHP_FUNCTION")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("confirm_iszmxw_compiled"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* For testing, remove later. */")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("PHP_FUNCTION")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("bcm_cal"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[a("strong",[t._v("3、然后打开 iszmxw.c，在 "),a("code",[t._v("PHP_FE(confirm_iszmxw_compiled, NULL)")]),t._v(" 下方加入以下内容。")])]),t._v(" "),a("div",{staticClass:"language-c extra-class"},[a("pre",{pre:!0,attrs:{class:"language-c"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" zend_function_entry iszmxw_functions"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("PHP_FE")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("confirm_iszmxw_compiled"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("NULL")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("           "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* For testing, remove later. */")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("PHP_FE")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("bcm_cal"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("   "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("NULL")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("       "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* For testing, remove later. */")]),t._v("\n        PHP_FE_END      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* Must be the last line in iszmxw_functions[] */")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[a("strong",[t._v("4、在次打开 iszmxw.c，在 "),a("code",[t._v('#include "php_iszmxw.h"')]),t._v(" 下方加入以下内容。")])]),t._v(" "),a("div",{staticClass:"language-c extra-class"},[a("pre",{pre:!0,attrs:{class:"language-c"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 添加引用一些声明")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token macro property"}},[t._v("#"),a("span",{pre:!0,attrs:{class:"token directive keyword"}},[t._v("include")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("<stdio.h>")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token macro property"}},[t._v("#"),a("span",{pre:!0,attrs:{class:"token directive keyword"}},[t._v("include")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("<stdlib.h>")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token macro property"}},[t._v("#"),a("span",{pre:!0,attrs:{class:"token directive keyword"}},[t._v("include")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("<dlfcn.h>")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token macro property"}},[t._v("#"),a("span",{pre:!0,attrs:{class:"token directive keyword"}},[t._v("include")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Cal.h"')])]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typedef")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("ptr_fun"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Infor "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("in"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//")]),t._v("\n\n")])])]),a("p",[a("strong",[t._v("5、最后在 iszmxw.c 的最末尾书写"),a("code",[t._v("bcm_cal")]),t._v("函数的内容：")])]),t._v(" "),a("div",{staticClass:"language-c extra-class"},[a("pre",{pre:!0,attrs:{class:"language-c"}},[a("code",[t._v("Infor infor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n * bcm_cal\n * */")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("PHP_FUNCTION")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("bcm_cal"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("handle"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("char")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("error"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" isage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" isgender"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("double")]),t._v(" isheight"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("double")]),t._v(" isweight"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("double")]),t._v(" isresistance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" result"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("zend_parse_parameters")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ZEND_NUM_ARGS")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" TSRMLS_CC"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"llddd"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("isage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("isgender"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("isheight"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("isweight"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("isresistance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" FAILURE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    infor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("age "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" isage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    infor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("height "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" isheight"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    infor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("weight "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" isweight"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    infor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("resistance "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" isresistance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("isgender "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        infor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("gender "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" MALE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        infor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("gender "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" FEMALE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    handle "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("dlopen")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"libbcm.so"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" RTLD_NOW"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("handle"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("printf")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"dlopen error !!!\\r\\n"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("exit")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("dlerror")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    ptr_fun pf "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ptr_fun"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("dlsym")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("handle"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"BCM_Cal"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("dlerror")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("NULL")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("printf")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"dlsym error!!!\\r\\n"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("exit")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("pf")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("infor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("array_init")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("return_value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("add_assoc_double")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("return_value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"BMI"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" infor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("BMI"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("           "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// BMI 体格指数")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("add_assoc_double")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("return_value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"PBF"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" infor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("PBF"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("           "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// PBF体脂肪率")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("add_assoc_double")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("return_value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"VFA"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" infor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("VFA"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("           "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// VFA内脏脂肪指数")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("add_assoc_double")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("return_value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"PBW"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" infor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("PBW"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("           "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// PBW体水分率")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("add_assoc_double")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("return_value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"SM"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" infor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SM"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("             "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// SM骨骼肌")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("add_assoc_double")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("return_value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"BMC"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" infor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("BMC"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("           "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 骨矿含量")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("add_assoc_double")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("return_value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"BMR"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" infor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("BMR"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("           "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 基础代谢")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("add_assoc_double")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("return_value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Protein"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" infor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Protein"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 蛋白质")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("add_assoc_double")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("return_value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"TBW"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" infor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("TBW"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("           "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//总水分重量")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("add_assoc_double")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("return_value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Minerals"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" infor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Minerals"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//无机盐")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("add_assoc_double")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("return_value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"BFM"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" infor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("BFM"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("           "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//脂肪重量")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("add_assoc_double")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("return_value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"FFM"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" infor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("FFM"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("           "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//去脂体重")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("add_assoc_double")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("return_value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"BodyAge"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" infor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("BodyAge"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//身体年龄")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("add_assoc_double")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("return_value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"TotalScore"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" infor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("TotalScore"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//综合评分")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("dlclose")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("handle"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//关闭调用动态库句柄")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("blockquote",[a("p",[t._v("最后将"),a("code",[t._v("Cal.h")]),t._v("传入到扩展的目录下面，保证引用不会出错")])])])},[],!1,null,null,null);s.default=r.exports}}]);